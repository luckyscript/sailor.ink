(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{393:function(s,n,a){"use strict";a.r(n);var t=a(8),e=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"客户端渲染的发展"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端渲染的发展"}},[s._v("#")]),s._v(" 客户端渲染的发展")]),s._v(" "),n("p",[s._v("随着"),n("code",[s._v("Angularjs")]),s._v("带入了"),n("code",[s._v("MVVM")]),s._v("思想，"),n("code",[s._v("React")]),s._v("和"),n("code",[s._v("Vue")]),s._v("的兴起，客户端渲染应用在前端开发中变得流行起来。所谓"),n("code",[s._v("客户端渲染")]),s._v("，指的是页面的dom结构都由前端js来生成，而服务端只是渲染了一个基础模板，这样大大的减少了服务端的压力。尤其是一些后台管控系统等对"),n("code",[s._v("seo")]),s._v("等不敏感的场景下，应用非常广泛。")]),s._v(" "),n("h2",{attrs:{id:"路由"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#路由"}},[s._v("#")]),s._v(" 路由")]),s._v(" "),n("p",[s._v("因为面向服务端的只是一个模板文件，所以前端应用的路由都是由前端自己来控制的。而通常前端路由的实现方式一种是hash方式，一种是history方式。我比较推荐history方式。")]),s._v(" "),n("h2",{attrs:{id:"部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[s._v("#")]),s._v(" 部署")]),s._v(" "),n("p",[s._v("关于客户端渲染应用的部署，我觉得有几点要注意：")]),s._v(" "),n("ol",[n("li",[s._v("前后端分离部署，前端不需要依赖后端。前后端是平等的关系。")]),s._v(" "),n("li",[s._v("机器资源宝贵，要做到合理利用。")]),s._v(" "),n("li",[s._v("访问链路不能过长。")])]),s._v(" "),n("p",[s._v("所以我有过几套发布部署的方案，也思考过一些方案的优缺点。")]),s._v(" "),n("ol",[n("li",[s._v("前端部署到有nginx应用的服务器上，后端部署到node服务器上（以node应用为例）。nginx设置反向代理，将需要打给后端的请求配置好。外部请求过来时，先打到nginx服务器上，开始渲染前端页面，页面中的请求再打到nginx服务器上，这时候会被反向代理到node服务器上，node作出响应后，nginx拿到后再返回给客户端。")]),s._v(" "),n("li",[s._v("前端部署到静态资源上，后端部署到node服务器上，nginx根据location来判断是否为前端静态文件，如果发现则直接请求静态资源，否则则打到node服务器上。")])]),s._v(" "),n("p",[s._v("两种方案，其实我个人觉得差不多，其实差别也不大。其实无论选择哪种方案，适合自己的才是最好的。我在设想部署这个博客的时候，打算用docker包掉一切，但是最后发现机器带不动～。所以我现在的部署方式类似第二种，本地写了一个脚本，本地编译 + scp至云端dist目录。而后端部分，则是压缩 -> scp上传 -> 执行脚本(解压、npm install、npm start)。")]),s._v(" "),n("p",[s._v("附送上 hash 路由 nginx的配置：")]),s._v(" "),n("h2",{attrs:{id:"nginx配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx配置"}},[s._v("#")]),s._v(" nginx配置")]),s._v(" "),n("div",{staticClass:"language-nginx line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-nginx"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" ~ /admin/")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v(" /Users/user/MySpace/nbook-admin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" index.html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" /Users/user/Myspace/nbook-admin/admin/.htaccess")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v(".htaccess")]),s._v(" "),n("div",{staticClass:"language-nginx line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-nginx"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" (!-e "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$request")]),s._v("\\_filename)")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rewrite")]),s._v(" ^/(.\\*)$ /admin/index.html?\\_ca\\_="),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(" last")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);